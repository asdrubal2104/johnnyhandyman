---
import { Menu, X, Phone, Mail } from "@lucide/astro";
---

<header class="sticky top-0 z-50 h-20">
  <!-- Header Background Layer (Separated to preserve stacking context for children) -->
  <div
    class="absolute inset-0 bg-black/95 backdrop-blur-md border-b border-white/10 z-0"
  >
  </div>

  <div class="relative z-50 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full">
    <div class="flex items-center justify-between h-full">
      <!-- Logo -->
      <a href="/" class="flex items-center gap-3 group">
        <div
          class="w-12 h-12 bg-linear-to-br from-orange-500 to-orange-600 rounded-lg flex items-center justify-center transform group-hover:scale-105 transition-transform"
        >
          <span class="text-white font-bold text-xl">JP</span>
        </div>
        <div class="flex flex-col">
          <span class="text-white font-bold text-xl font-inter">Johnny Pro</span
          >
          <span class="text-orange-500 text-xs font-medium"
            >Handyman Services</span
          >
        </div>
      </a>

      <!-- Desktop Navigation -->
      <nav class="hidden md:flex items-center gap-8">
        <a
          href="/"
          class="text-white hover:text-orange-500 transition-colors font-medium"
          >Home</a
        >
        <a
          href="/services"
          class="text-white hover:text-orange-500 transition-colors font-medium"
          >Services</a
        >
        <a
          href="/locations"
          class="text-white hover:text-orange-500 transition-colors font-medium"
          >Locations</a
        >
        <a
          href="/about"
          class="text-white hover:text-orange-500 transition-colors font-medium"
          >About</a
        >
        <a
          href="/gallery"
          class="text-white hover:text-orange-500 transition-colors font-medium"
          >Gallery</a
        >
        <a
          href="/contact"
          class="text-white hover:text-orange-500 transition-colors font-medium"
          >Contact</a
        >
      </nav>

      <!-- Contact Info & CTA -->
      <div class="hidden lg:flex items-center gap-4">
        <a
          href="tel:+18015551234"
          class="flex items-center gap-2 text-white hover:text-orange-500 transition-colors"
        >
          <Phone class="w-4 h-4" />
          <span class="text-sm font-medium">(801) 555-1234</span>
        </a>
        <a
          href="/contact"
          class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-2.5 rounded-lg font-semibold transition-all hover:scale-105 active:scale-95 shadow-lg shadow-orange-500/20"
        >
          Get Quote
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <button
        id="mobile-menu-button"
        class="md:hidden text-white p-2 hover:bg-white/10 rounded-lg transition-colors relative z-50"
        aria-label="Toggle menu"
      >
        <Menu class="w-6 h-6 transition-opacity duration-300" id="menu-icon" />
        <X
          class="w-6 h-6 absolute top-2 left-2 opacity-0 transition-opacity duration-300"
          id="close-icon"
        />
      </button>
    </div>
  </div>

  <!-- Mobile Menu Overlay -->
  <div
    id="mobile-menu"
    class="fixed inset-0 z-40 bg-black/95 backdrop-blur-xl transform translate-x-full transition-transform duration-300 ease-in-out md:hidden flex flex-col pt-24 pb-8 px-6 overflow-y-auto"
  >
    <nav class="flex flex-col space-y-6">
      <a
        href="/"
        class="text-2xl font-bold text-white hover:text-orange-500 transition-colors"
        data-mobile-link>Home</a
      >
      <a
        href="/services"
        class="text-2xl font-bold text-white hover:text-orange-500 transition-colors"
        data-mobile-link>Services</a
      >
      <a
        href="/locations"
        class="text-2xl font-bold text-white hover:text-orange-500 transition-colors"
        data-mobile-link>Locations</a
      >
      <a
        href="/about"
        class="text-2xl font-bold text-white hover:text-orange-500 transition-colors"
        data-mobile-link>About</a
      >
      <a
        href="/gallery"
        class="text-2xl font-bold text-white hover:text-orange-500 transition-colors"
        data-mobile-link>Gallery</a
      >
      <a
        href="/contact"
        class="text-2xl font-bold text-white hover:text-orange-500 transition-colors"
        data-mobile-link>Contact</a
      >
    </nav>

    <div class="mt-auto pt-8 border-t border-white/10 space-y-6">
      <a
        href="tel:+18015551234"
        class="flex items-center gap-3 text-xl text-white hover:text-orange-500 transition-colors"
      >
        <div
          class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center"
        >
          <Phone class="w-5 h-5" />
        </div>
        <span class="font-medium">(801) 555-1234</span>
      </a>

      <a
        href="mailto:info@johnnypro.com"
        class="flex items-center gap-3 text-xl text-white hover:text-orange-500 transition-colors"
      >
        <div
          class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center"
        >
          <Mail class="w-5 h-5" />
        </div>
        <span class="font-medium">info@johnnypro.com</span>
      </a>

      <a
        href="/contact"
        class="block w-full text-center bg-orange-500 hover:bg-orange-600 text-white px-6 py-4 rounded-xl font-bold text-lg shadow-lg active:scale-95 transition-all"
        data-mobile-link
      >
        Get Free Quote
      </a>
    </div>
  </div>
</header>

<script>
  function setupMobileMenu() {
    const button = document.getElementById("mobile-menu-button");
    const menu = document.getElementById("mobile-menu");
    const menuIcon = document.getElementById("menu-icon");
    const closeIcon = document.getElementById("close-icon");
    const links = document.querySelectorAll("[data-mobile-link]");

    if (!button || !menu || !menuIcon || !closeIcon) return;

    function toggleMenu() {
      const isClosed = menu?.classList.contains("translate-x-full");

      if (isClosed) {
        // Open
        menu?.classList.remove("translate-x-full");
        menuIcon?.classList.add("opacity-0");
        closeIcon?.classList.remove("opacity-0");
        document.body.style.overflow = "hidden"; // Prevent scrolling
      } else {
        // Close
        menu?.classList.add("translate-x-full");
        menuIcon?.classList.remove("opacity-0");
        closeIcon?.classList.add("opacity-0");
        document.body.style.overflow = ""; // Restore scrolling
      }
    }

    // Toggle on button click
    button.onclick = (e) => {
      e.stopPropagation();
      toggleMenu();
    };

    // Close on link click
    links.forEach((link) => {
      link.addEventListener("click", () => {
        if (!menu.classList.contains("translate-x-full")) {
          toggleMenu();
        }
      });
    });
  }

  setupMobileMenu();
  document.addEventListener("astro:page-load", setupMobileMenu);
</script>
